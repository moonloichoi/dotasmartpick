:root{
  --bg:#0b0f14; --card:#111722; --soft:#151f2b; --text:#e6edf3; --muted:#9fb0c3; --line:#1d2a3a; --brand:#3b82f6;
  --hdr:56px; --wmh:22px; --gap:12px;
  --queueBand:120px;
  --poolRow:72px;
  --sugRow:96px; --sugVisible:2;
}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);overflow:hidden}

header{position:sticky;top:0;z-index:5;background:rgba(11,15,20,.85);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border-bottom:1px solid var(--line)}
.bar{max-width:1200px;margin:0 auto;padding:0 16px;height:var(--hdr);display:flex;gap:12px;align-items:center}
.brand{font-weight:800}
.strap{flex:1;text-align:center;color:var(--muted)}

main{max-width:1200px;margin:0 auto;padding:8px;display:flex;flex-direction:column;gap:var(--gap);height:calc(100vh - var(--hdr) - var(--wmh) - 10px);overflow:hidden}

.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:10px 12px}

/* Queue */
.queue{
  flex:0 0 var(--queueBand);
  min-height:var(--queueBand);
  display:flex;flex-direction:column;gap:8px;
}
.sectionTitle{display:flex;align-items:center;gap:8px;margin-bottom:6px;color:#cfe1ff}
.sectionTitle svg{width:18px;height:18px;opacity:.9}
.qbody{display:flex;flex-direction:column;gap:10px}
.slots{display:flex;gap:8px;justify-content:center}
.slot{width:96px;aspect-ratio:16/9;border-radius:10px;display:grid;place-items:center;border:1px dashed #2a3a52;color:#7f92a7;background:#0e141b;overflow:hidden}
.slot.filled{border-style:solid;border-color:#2d466a}
.slot img{width:100%;height:100%;object-fit:cover}
.qactions{display:flex;justify-content:center;margin-top:4px}
.btn{background:#182330;border:1px solid #23334a;color:#cfe1ff;border-radius:14px;padding:.6rem 1.1rem;font-size:1rem;font-weight:800;cursor:pointer}

/* split */
.content{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap);flex:1;min-height:0}

/* Pool (fill toàn bộ phần còn lại theo Option A) */
.panel{display:flex;flex-direction:column;min-height:0}
.searchbar{position:relative;margin-bottom:8px}
.searchbar input{width:100%;background:#0e141b;border:1px solid #1b2a3d;color:var(--text);border-radius:10px;padding:.55rem .7rem}
.clearX{position:absolute;right:6px;top:50%;transform:translateY(-50%);width:22px;height:22px;border-radius:6px;border:1px solid #2a3a52;background:#13202d;color:#cfe1ff;cursor:pointer}

.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  grid-auto-rows:var(--poolRow);
  gap:8px;
  flex:1;
  min-height:0;
  overflow:auto;
  padding-right:4px;
}
.tile{position:relative;border:1px solid #213247;border-radius:10px;overflow:hidden;cursor:pointer;background:#1a2432;height:100%}
.tile img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:saturate(92%) contrast(1.02)}
.tile::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.0) 40%, rgba(0,0,0,.55))}
.tname{position:absolute;left:8px;bottom:6px;font-weight:800;text-shadow:0 2px 8px rgba(0,0,0,.6)}
.tile.picked{outline:3px solid #3b82f6; box-shadow:0 0 0 2px rgba(59,130,246,.35) inset}
.badge{position:absolute;left:6px;top:6px;background:#0e2c62;border:1px solid #2e5fb6;color:#cfe1ff;border-radius:8px;padding:2px 6px;font-size:10px;font-weight:900}

/* Suggestions */
.list{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  grid-auto-rows:var(--sugRow);
  gap:8px;
  max-height:calc(var(--sugRow)*var(--sugVisible) + 8px);
  min-height:calc(var(--sugRow)*var(--sugVisible) + 8px);
  overflow:auto;
  padding-right:4px;
}
.sug{position:relative;border:1px solid #213247;border-radius:12px;overflow:hidden;background:#1a2432;height:100%}
.sug img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
.sug::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.0) 40%, rgba(0,0,0,.6))}
.sname{position:absolute;left:8px;bottom:6px;font-weight:800;text-shadow:0 2px 8px rgba(0,0,0,.6)}

/* nguồn (icon hero 16:9), hiển thị đúng tỉ lệ & đủ số lượng */
.sources{
  position:absolute;right:6px;top:6px;
  display:flex;gap:4px;align-items:center;flex-wrap:nowrap;
  min-width:56px;
}
.src{
  flex:0 0 auto;
  width:26px;
  aspect-ratio:16/9;
  height:auto;
  border-radius:6px;overflow:hidden;
  border:1px solid rgba(255,255,255,.3);
  box-shadow:0 1px 4px rgba(0,0,0,.35);
  background:#0e141b;
}
.src img{display:block;width:100%;height:100%;object-fit:contain}
.src.more{
  display:grid;place-items:center;
  width:26px;aspect-ratio:16/9;height:auto;
  background:#0e141b;color:#cfe1ff;font-size:.7rem;font-weight:800;border:1px solid #2a3a52;border-radius:6px;
}

/* watermark + toast */
.watermark{position:fixed;left:50%;transform:translateX(-50%);bottom:6px;text-align:center;color:var(--muted);opacity:.45;font-size:12px;pointer-events:none}
.toast{position:fixed;left:50%;bottom:calc(var(--wmh) + 14px);transform:translate(-50%,0);background:#1f2d3a;color:#d9edff;border:1px solid #2a3a3
;border-radius:10px;padding:.45rem .7rem;font-weight:700;opacity:.95}

/* Mobile portrait */
@media (max-width:428px){
  :root{ --poolRow:70px; --sugRow:92px; --queueBand:110px; }
  .content{grid-template-columns:1fr}
  .grid{grid-template-columns:repeat(3,1fr)}
  .list{grid-template-columns:repeat(2,1fr)}
  .slot{width:88px}
}

/* === OVERRIDE đảm bảo ưu tiên trên Pages cache === */
.panel .sug .sources{min-width:56px}
.panel .sug .sources .src{width:26px;aspect-ratio:16/9;height:auto;border-radius:6px}
.panel .sug .sources .src img{width:100%;height:100%;object-fit:contain}
.panel .sug .sources .src.more{width:26px;aspect-ratio:16/9;height:auto;border-radius:6px}
