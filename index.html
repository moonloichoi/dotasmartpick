<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dota2 OutPick</title>
  <style>
    :root{
      --bg:#0b0f14; --card:#111722; --soft:#151f2b; --text:#e6edf3; --muted:#9fb0c3; --line:#1d2a3a; --brand:#3b82f6;
      --hdr:56px; --wmh:22px;
      --poolRow:64px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);overflow:hidden}

    /* Header */
    header{position:sticky;top:0;z-index:5;background:rgba(11,15,20,.85);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border-bottom:1px solid var(--line)}
    .bar{max-width:1200px;margin:0 auto;padding:.75rem 1rem;display:flex;gap:12px;align-items:center}
    .brand{font-weight:800}
    .tag{flex:1;text-align:center;color:var(--muted)}

    /* Layout */
    main{max-width:1200px;margin:0 auto;padding:12px;display:grid;gap:12px;grid-template-columns:1fr 1fr;grid-template-rows:auto 1fr;height:calc(100vh - var(--hdr) - var(--wmh))}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px}

    /* Enemy queue */
    .queue{grid-column:1 / -1}
    .sectionTitle{display:flex;align-items:center;gap:8px;margin-bottom:6px;color:#cfe1ff}
    .sectionTitle svg{width:18px;height:18px;opacity:.9}
    .qbody{display:flex;flex-direction:column;gap:8px}
    .slots{display:flex;gap:8px;justify-content:center}
    .slot{width:104px;aspect-ratio:16/9;border-radius:10px;display:grid;place-items:center;border:1px dashed #2a3a52;color:#7f92a7;background:#0e141b;overflow:hidden}
    .slot.filled{border-style:solid;border-color:#2d466a}
    .slot img{width:100%;height:100%;object-fit:cover}
    .qactions{display:flex;justify-content:center;margin-top:4px}
    .btn{background:#182330;border:1px solid #23334a;color:#cfe1ff;border-radius:14px;padding:.6rem 1.1rem;font-size:1rem;font-weight:700;cursor:pointer}

    /* Pool (left) */
    .pool{display:flex;flex-direction:column;min-height:0}
    .searchbar{position:relative;margin-bottom:8px}
    .searchbar input{width:100%;background:#0e141b;border:1px solid #1b2a3d;color:var(--text);border-radius:10px;padding:.55rem .7rem}
    .searchbar button.clearX{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:#0e141b;border:1px solid #213247;color:#9fb0c3;border-radius:8px;padding:.2rem .45rem;cursor:pointer}
    .grid{
      display:grid;
      grid-template-columns:repeat(5,1fr);
      grid-auto-rows:calc(var(--poolRow) + 18px);
      gap:8px;
      max-height:100%;
      overflow:auto;
      padding-right:4px;
    }
    .tile{border:1px solid #213247;border-radius:10px;background:#1a2432;overflow:hidden;cursor:pointer;display:flex;flex-direction:column;transition:transform .15s ease, filter .15s ease;}
    .tile:hover{transform:scale(1.05);filter:brightness(1.08);}
    .thumb{position:relative;width:100%;aspect-ratio:16/9;overflow:hidden}
    .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    .name{padding:6px 8px 8px 8px;font-weight:800;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}
    .tile.picked{outline:3px solid var(--brand); box-shadow:0 0 0 2px rgba(59,130,246,.35) inset; filter:saturate(1.05) brightness(1.05)}
    .pickedBadge{position:absolute;top:6px;left:6px;background:var(--brand);border-radius:8px;padding:.1rem .35rem;font-size:.7rem;font-weight:800;color:#fff;box-shadow:0 2px 8px rgba(0,0,0,.35)}

    /* Suggestions (right) – one row, vertically centered */
    .panel{display:flex;flex-direction:column;justify-content:center;gap:12px;min-height:0}
    .panel .card{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:0}
    .list{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;overflow:hidden;align-items:center;justify-items:center}
    .sug{border:1px solid #213247;border-radius:12px;background:#1a2432;overflow:hidden;display:flex;flex-direction:column;width:100%;max-width:180px}
    .sug .thumb{position:relative;width:100%;overflow:hidden;border-bottom:1px solid #213247}
    .sug.hero .thumb{aspect-ratio:16/9}
    .sug.item .thumb{aspect-ratio:11/8}
    .sname{padding:6px 8px 8px 8px;font-weight:800;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}
    .sources{position:absolute;right:6px;top:6px;display:flex;gap:3px;flex-wrap:wrap}
    .src{width:18px;height:18px;border-radius:4px;overflow:hidden;border:1px solid rgba(255,255,255,.35)}
    .src img{width:100%;height:100%;object-fit:cover}

    /* Toast */
    .toast{
      position:fixed;bottom:60px;left:50%;transform:translateX(-50%);
      background:rgba(20,28,40,.95);color:#fff;padding:10px 18px;border-radius:10px;font-weight:700;font-size:.9rem;border:1px solid #3b82f6;z-index:50;display:none
    }

    /* Watermark */
    footer{max-width:1200px;margin:4px auto 6px;text-align:center;color:var(--muted);opacity:.45;font-size:12px;height:var(--wmh)}

    @media (max-width:428px){
      main{grid-template-columns:1fr}
      .grid{grid-template-columns:repeat(3,1fr)}
      .list{grid-template-columns:repeat(2,1fr)}
      .slot{width:92px}
    }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">Dota2 OutPick</div>
      <div class="tag">Everything can work in Dota!</div>
      <div style="width:18px"></div>
    </div>
  </header>

  <main>
    <!-- Enemy queue -->
    <section class="queue card">
      <div class="sectionTitle">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l7 4v6c0 5-3.8 9.3-7 10-3.2-.7-7-5-7-10V6l7-4zM7 9h10v3c0 3.7-2.6 7.3-5 8-2.4-.7-5-4.3-5-8V9z"/></svg>
        <strong>Enemy queue</strong>
        <span id="progress" style="color:var(--muted);margin-left:6px">0/5</span>
      </div>
      <div class="qbody">
        <div id="slots" class="slots"></div>
        <div class="qactions"><button id="clear" class="btn">Clear</button></div>
      </div>
    </section>

    <!-- Pool (left) -->
    <section class="pool card">
      <div class="sectionTitle">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a1 1 0 011 1v2a1 1 0 11-2 0V3a1 1 0 011-1zm0 16a5 5 0 100-10 5 5 0 000 10zm0-2a3 3 0 110-6 3 3 0 010 6zm9-4a1 1 0 010 2h-2a1 1 0 110-2h2zM5 12a1 1 0 100 2H3a1 1 0 100-2h2zm13.66-6.66a1 1 0 011.41 1.41l-1.41 1.41a1 1 0 01-1.41-1.41l1.41-1.41zM6.34 17.66a1 1 0 01-1.41-1.41l1.41-1.41a1 1 0 011.41 1.41L6.34 17.66z"/></svg>
        <strong>Choose your enemies</strong>
      </div>
      <div class="searchbar">
        <input id="search" placeholder="Search hero…" />
        <button id="clearSearch" class="clearX" title="Clear">×</button>
      </div>
      <div id="grid" class="grid"></div>
    </section>

    <!-- Suggestions (right) -->
    <section class="panel">
      <div class="card">
        <div class="sectionTitle">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3C7 3 3 7 3 12v2h5l2 4h4l2-4h5v-2c0-5-4-9-9-9z"/></svg>
          <strong>You should pick:</strong>
        </div>
        <div id="pickList" class="list"></div>
      </div>
      <div class="card">
        <div class="sectionTitle">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 6V5a4 4 0 118 0v1h3a1 1 0 011 1v11a3 3 0 01-3 3H7a3 3 0 01-3-3V7a1 1 0 011-1h3zm2 0h4V5a2 2 0 10-4 0v1z"/></svg>
          <strong>You should buy:</strong>
        </div>
        <div id="itemList" class="list"></div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast"></div>
  <footer>designed by moonloichoi in saigon</footer>

  <!-- JS inline -->
  <script>
    let HEROES={}, ITEMS={}, MAX=5, enemyQueue=[];
    const $=id=>document.getElementById(id);
    const slots=$("slots"),grid=$("grid"),progress=$("progress"),clearBtn=$("clear");
    const search=$("search"),pickList=$("pickList"),itemList=$("itemList"),clearSearchBtn=$("clearSearch"),toastEl=$("toast");

    const heroImg=s=>`./assets/heroes/${s}.png`; const itemImg=s=>`./assets/items/${s}.png`;
    const placeholder=t=>'data:image/svg+xml;utf8,'+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 240"><rect fill="#0f1722" width="400" height="240"/><text x="20" y="210" fill="#cfe1ff" font-family="system-ui,Segoe UI,Roboto" font-size="26" font-weight="700">${t||'HERO'}</text></svg>`);
    const itemSlug=n=>(n||'').toLowerCase().replace(/[^a-z0-9]+/g,'_').replace(/^_|_$/g,'');

    function toast(msg){toastEl.textContent=msg;toastEl.style.display='block';clearTimeout(toast._t);toast._t=setTimeout(()=>toastEl.style.display='none',1800);}

    async function loadData(){
      const [heroes,items]=await Promise.all([
        fetch('./heroes.json?v='+Date.now()).then(r=>r.json()),
        fetch('./items.json?v='+Date.now()).then(r=>r.json()).catch(()=>({}))
      ]);
      Object.keys(heroes).forEach(s=>heroes[s].img=heroImg(s));
      Object.keys(items).forEach(s=>items[s].img=itemImg(s));
      HEROES=heroes;ITEMS=items;init();
    }

    function renderQueue(){
      slots.innerHTML='';
      for(let i=0;i<MAX;i++){
        const s=document.createElement('div');const slug=enemyQueue[i];
        if(slug){
          s.className='slot filled';
          const img=new Image();img.src=HEROES[slug]?.img||placeholder('HERO');img.alt=HEROES[slug]?.name||'';
          s.title=(HEROES[slug]?.name||'')+' — click to remove';s.onclick=()=>{enemyQueue.splice(i,1);update();};
          s.appendChild(img);
        }else{s.className='slot';s.textContent=(i+1);}
        slots.appendChild(s);
      }
      progress.textContent=`${enemyQueue.length}/${MAX}`;
    }

    function renderPool(){
      grid.innerHTML='';
      const term=(search?.value||'').trim().toLowerCase();
      Object.entries(HEROES).filter(([_,h])=>!term||h.name.toLowerCase().includes(term))
      .sort((a,b)=>a[1].name.localeCompare(b[1].name))
      .forEach(([slug,h])=>{
        const picked=enemyQueue.includes(slug);
        const t=document.createElement('div');t.className='tile'+(picked?' picked':'');
        t.innerHTML=`<div class="thumb"><img src="${h.img||placeholder('HERO')}" alt="${h.name}">${picked?'<div class="pickedBadge">PICKED</div>':''}</div><div class="name">${h.name}</div>`;
        t.onclick=()=>{
          const idx=enemyQueue.indexOf(slug);
          if(idx>=0)enemyQueue.splice(idx,1);
          else if(enemyQueue.length<MAX)enemyQueue.push(slug);
          else {toast("You have queued 5 enemies already!");return;}
          update();
        };
        grid.appendChild(t);
      });
    }

    function renderSuggestions(){
      const heroSources=new Map(),itemSources=new Map();
      enemyQueue.forEach(eSlug=>{
        const enemy=HEROES[eSlug];
        (enemy?.counters||[]).forEach(sug=>{
          if(enemyQueue.includes(sug))return;
          if(!heroSources.has(sug))heroSources.set(sug,new Set());
          heroSources.get(sug).add(eSlug);
        });
        (enemy?.item_counters||[]).forEach(it=>{
          const key=itemSlug(it);
          if(!itemSources.has(key))itemSources.set(key,new Set());
          itemSources.get(key).add(eSlug);
        });
      });

      // Heroes: 1 hàng 5 ô
      pickList.innerHTML='';
      const heroList=[...heroSources.keys()].filter(s=>HEROES[s]).sort((a,b)=>HEROES[a].name.localeCompare(HEROES[b].name)).slice(0,5);
      if(!heroList.length)pickList.innerHTML=`<span style="color:var(--muted)">Add heroes to the queue.</span>`;
      heroList.forEach(slug=>{
        const h=HEROES[slug];const e=document.createElement('div');e.className='sug hero';
        e.innerHTML=`<div class="thumb"><img src="${h.img}" alt="${h.name}"><div class="sources"></div></div><div class="sname">${h.name}</div>`;
        const srcWrap=e.querySelector('.sources');
        [...(heroSources.get(slug)||[])].forEach(slg=>{
          const box=document.createElement('div');box.className='src';
          box.innerHTML=`<img src="${HEROES[slg]?.img||placeholder('H')}" alt="${HEROES[slg]?.name||''}">`;
          srcWrap.appendChild(box);
        });
        pickList.appendChild(e);
      });

      // Items: 1 hàng 5 ô
      itemList.innerHTML='';
      const itemKeys=[...itemSources.keys()].sort((a,b)=>(ITEMS[a]?.name||a).localeCompare(ITEMS[b]?.name||b)).slice(0,5);
      if(!itemKeys.length)itemList.innerHTML=`<span style="color:var(--muted)">Add heroes to the queue.</span>`;
      itemKeys.forEach(key=>{
        const meta=ITEMS[key]||{name:key,img:placeholder('ITEM')};
        const e=document.createElement('div');e.className='sug item';
        e.innerHTML=`<div class="thumb"><img src="${meta.img}" alt="${meta.name}"><div class="sources"></div></div><div class="sname">${meta.name}</div>`;
        const srcWrap=e.querySelector('.sources');
        [...(itemSources.get(key)||[])].forEach(slg=>{
          const box=document.createElement('div');box.className='src';
          box.innerHTML=`<img src="${HEROES[slg]?.img||placeholder('H')}" alt="${HEROES[slg]?.name||''}">`;
          srcWrap.appendChild(box);
        });
        itemList.appendChild(e);
      });
    }

    function save(){ localStorage.setItem('enemyQueue', JSON.stringify(enemyQueue)); }
    function load(){ try{ enemyQueue = JSON.parse(localStorage.getItem('enemyQueue')||'[]'); }catch{ enemyQueue=[]; } }
    function update(){ renderQueue(); renderPool(); renderSuggestions(); save(); }

    clearBtn.onclick=()=>{ enemyQueue=[]; update(); };
    search.addEventListener('input', ()=>renderPool());
    clearSearchBtn.onclick=()=>{ search.value=''; renderPool(); search.focus(); };

    function init(){ load(); update(); }
    loadData();
  </script>
</body>
</html>
